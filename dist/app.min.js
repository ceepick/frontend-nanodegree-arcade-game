!function(){function e(e){e instanceof Array?e.forEach(function(e){t(e)}):t(e)}function t(e){if(a[e])return a[e];var t=new Image;t.onload=function(){a[e]=t,n()&&r.forEach(function(e){e()})},a[e]=!1,t.src=e}function i(e){return a[e]}function n(){var e=!0;for(var t in a)a.hasOwnProperty(t)&&!a[t]&&(e=!1);return e}function s(e){r.push(e)}var a={},r=[];window.Resources={load:e,get:i,onReady:s,isReady:n}}();var Menus={MapSpriteUrl:{W:"images/block-water.png",S:"images/block-stone.png",G:"images/block-grass.png",_:null},PlayerSpriteUrl:{B:"images/char-boy.png",C:"images/char-cat-girl.png",H:"images/char-horn-girl.png",P:"images/char-pink-girl.png",R:"images/char-princess-girl.png",_:null}};!function(){Menus.GameSelect=function(){var e=Menus.MapSpriteUrl;this.map={images:[[e.S,e.S,e.S,e.S,e.S],[e.S,e.W,e.W,e.W,e.S],[e.S,e.S,e.S,e.S,e.S],[e.S,e.S,e.S,e.S,e.S],[e.S,e.G,e.G,e.G,e.S],[e.S,e.S,e.S,e.S,e.S]],numRows:6,numCols:5}},Menus.PlayerSelect=function(){var e=Menus.MapSpriteUrl;this.map={images:[[e.G,e.G,e.G,e.G,e.G],[e.G,e.G,e.G,e.G,e.G],[e.W,e.S,e.S,e.S,e.W],[e.W,e.W,e.S,e.W,e.W],[e.W,e.S,e.S,e.S,e.W],[e.G,e.G,e.G,e.G,e.G]],numRows:6,numCols:5},e=Menus.PlayerSpriteUrl,this.players={images:[[e._,e._,e._,e._,e._],[e._,e._,e._,e._,e._],[e._,e.H,e._,e.B,e._],[e._,e._,e.R,e._,e._],[e._,e.P,e._,e.C,e._],[e._,e._,e._,e._,e._]],numRows:6,numCols:5}}}();var Levels={MapSpriteUrl:{W:"images/block-water.png",S:"images/block-stone.png",G:"images/block-grass.png",_:null}};!function(){Levels.Frogger=function(){var e=Levels.MapSpriteUrl;this.map={images:[[e.W,e.W,e.S,e.W,e.W],[e.S,e.S,e.S,e.S,e.S],[e.S,e.S,e.S,e.S,e.S],[e.S,e.S,e.S,e.S,e.S],[e.G,e.G,e.G,e.G,e.G],[e.G,e.G,e.G,e.G,e.G]],numRows:6,numCols:5}},Levels.GemCollector=function(){var e=Levels.MapSpriteUrl;this.map={images:[[e.S,e.G,e.G,e.G,e.S],[e.G,e.G,e.G,e.G,e.G],[e.G,e.G,e.G,e.G,e.G],[e.G,e.G,e.G,e.G,e.G],[e.G,e.G,e.G,e.G,e.G],[e.S,e.G,e.G,e.G,e.S]],numRows:6,numCols:5}}}();var Models={EntityType:{BOY:0,GIRL_CAT:1,GIRL_HORN:2,GIRL_PINK:3,GIRL_PRINCESS:4,BUG:5,GEM_GREEN:6,GEM_BLUE:7,GEM_ORANGE:8},GemType:{GREEN:0,BLUE:1,ORANGE:2},get SPRITE_WIDTH(){return 101},get SPRITE_Y_INITIAL_POSITION(){return-30},get SPRITE_Y_OFFSET(){return 83},get PLAYER_SPRITE_COLLISION_HEIGHT(){return 76}};!function(){function e(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function t(e,t){var i;switch(e){case Models.EntityType.BOY:i=t?"images/char-boy-inv.png":"images/char-boy.png";break;case Models.EntityType.GIRL_CAT:i=t?"images/char-cat-girl-inv.png":"images/char-cat-girl.png";break;case Models.EntityType.GIRL_HORN:i=t?"images/char-horn-girl-inv.png":"images/char-horn-girl.png";break;case Models.EntityType.GIRL_PINK:i=t?"images/char-pink-girl-inv.png":"images/char-pink-girl.png";break;case Models.EntityType.GIRL_PRINCESS:i=t?"images/char-princess-girl-inv.png":"images/char-princess-girl.png";break;case Models.EntityType.BUG:i="images/enemy-bug.png";break;case Models.EntityType.GEM_GREEN:i="images/gem-green.png";break;case Models.EntityType.GEM_BLUE:i="images/gem-blue.png";break;case Models.EntityType.GEM_ORANGE:i="images/gem-orange.png";break;default:i=void 0}return i}function i(e,t,i){var n=t.x-e.x,s=t.y-e.y;return{x:e.x+n*i,y:e.y+s*i}}var n=new Levels.Frogger;Models.Entity=function(e){this.entityType=e,this.sprite=t(e,!1),this.spriteSize={width:101,height:171},this.spriteOffset={x:0,y:-30},this.blockOffset={x:101,y:83}},Models.Entity.prototype.collisionRect=function(){return{x:this.origin.x+this.collisionOffset.x,y:this.origin.y+this.collisionOffset.y,width:this.collisionSize.width,height:this.collisionSize.height}},Models.Entity.prototype.isOnCanvas=function(){var e=this.origin.x,t=this.origin.y;return e>-this.spriteSize.width&&e<ctx.canvas.width&&t>=-30&&t<=(n.map.images.length-1)*this.blockOffset.y-30},Models.Enemy=function(t){Models.Entity.call(this,t),this.collisionOffset={x:1,y:77},this.collisionSize={width:98,height:66},this.velocity=e(1,6)},Models.Enemy.prototype=Object.create(Models.Entity.prototype),Models.Enemy.prototype.update=function(e){this.origin.x+=this.spriteSize.width*this.velocity*e},Models.Enemy.prototype.render=function(){this.isOnCanvas()?ctx.drawImage(Resources.get(this.sprite),this.origin.x,this.origin.y):(this.origin=this.initialOrigin,this.velocity=e(1,6))},Models.FroggerEnemy=function(t){Models.Enemy.call(this,t),Object.defineProperty(this,"initialOrigin",{get:function(){var t=-this.blockOffset.x,i=this.spriteOffset.y+this.blockOffset.y*e(1,3);return{x:t,y:i}}}),this.origin=this.initialOrigin},Models.FroggerEnemy.prototype=Object.create(Models.Enemy.prototype),Models.GemCollectorEnemy=function(t){Models.Enemy.call(this,t),Object.defineProperty(this,"initialOrigin",{get:function(){var t=-this.blockOffset.x,i=this.spriteOffset.y+this.blockOffset.y*e(0,5);return{x:t,y:i}}}),this.origin=this.initialOrigin},Models.GemCollectorEnemy.prototype=Object.create(Models.Enemy.prototype),Models.Player=function(e){Models.Entity.call(this,e),this.State={PLAYING:0,WON:1,RESET:2,INVINCIBILITY:3},this.state=this.State.PLAYING,this.collisionOffset={x:30,y:62},this.collisionSize={width:40,height:70},this.chatBubbleSprite=Resources.get("images/obj-speech-bubble.png"),this.lAnimationDuration=300,this.lInvincibilityDuration=3e3,this.lInitialTime=null,this.lPercentComplete=null,this.lInitialPosition=null},Models.Player.prototype=Object.create(Models.Entity.prototype),Models.Player.prototype.updateResetAnimation=function(){ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);var e=Date.now();null===this.lInitialTime?(this.lInitialTime=e,this.lInitialPosition=this.origin):(this.lPercentComplete=(e-this.lInitialTime)/this.lAnimationDuration,this.lPercentComplete<=1?this.origin=i(this.lInitialPosition,this.initialOrigin,this.lPercentComplete):(Engine.currentGame()===Engine.Game.FROGGER?this.state=this.State.PLAYING:(this.state=this.State.INVINCIBILITY,this.sprite=t(this.entityType,!0)),this.lInitialTime=this.lPercentComplete=this.lInitialPosition=null,this.origin=this.initialOrigin))},Models.Player.prototype.updateInvincibility=function(){ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);var e=Date.now();null===this.lInitialTime?this.lInitialTime=e:(this.lPercentComplete=(e-this.lInitialTime)/this.lInvincibilityDuration,this.lPercentComplete>=1&&(this.state=this.State.PLAYING,this.sprite=t(this.entityType,!1),this.lInitialTime=this.lPercentComplete=this.lInitialPosition=null))},Models.Player.prototype.render=function(){if(this.isOnCanvas()){var e=this.origin;if(ctx.drawImage(Resources.get(this.sprite),e.x,e.y),this.state===this.State.WON){var t=this.collisionSize;ctx.drawImage(this.chatBubbleSprite,e.x+t.width,e.y+t.height/2),ctx.fillText(this.chatBubbleText(),e.x+this.spriteSize.width,e.y+t.height)}}},Models.Player.prototype.update=function(){this.state===this.State.WON?(ctx.font="20px VT323",ctx.fillStyle="black",ctx.textAlign="center"):this.state===this.State.RESET?this.updateResetAnimation():this.state===this.State.INVINCIBILITY&&this.updateInvincibility()},Models.Player.prototype.mapLocationIndices=function(){return{x:this.origin.x/this.blockOffset.x,y:(this.origin.y+30)/this.blockOffset.y}},Models.Player.prototype.chatBubbleText=function(){var e=Models.EntityType;switch(this.entityType){case e.BOY:return"Bummer";case e.GIRL_CAT:return"NYAN!!!";case e.GIRL_HORN:return"No problem";case e.GIRL_PINK:return"*headbangs*";case e.GIRL_PRINCESS:return"Bless you!";default:return""}},Models.Player.prototype.handleInput=function(e){var t=Engine.currentState(),i=Engine.State;if((t===i.LEVEL_FROGGER||t===i.LEVEL_GEM_COLLECTOR)&&(this.state===this.State.PLAYING||this.state===this.State.INVINCIBILITY)&&this.isValidMove(e)){var n=this.origin,s=this.blockOffset;switch(e){case"left":n.x-=s.x;break;case"up":n.y-=s.y;break;case"right":n.x+=s.x;break;case"down":n.y+=s.y}}},Models.FroggerPlayer=function(e){Models.Player.call(this,e),Object.defineProperty(this,"initialOrigin",{get:function(){var e=2*this.blockOffset.x,t=this.spriteOffset.y+5*this.blockOffset.y;return{x:e,y:t}}}),this.origin=this.initialOrigin},Models.FroggerPlayer.prototype=Object.create(Models.Player.prototype),Models.FroggerPlayer.prototype.isValidMove=function(e){var t=this.mapLocationIndices(),i=t.x,s=t.y;switch(e){case"left":i-=1;break;case"up":s-=1;break;case"right":i+=1;break;case"down":s+=1}return!(i<0||i>4||s<0||s>5)&&n.map.images[s][i]!==Levels.MapSpriteUrl.W},Models.FroggerPlayer.prototype.isWinningMove=function(){var e=this.mapLocationIndices();return 2===e.x&&0===e.y},Models.FroggerPlayer.prototype.handleInput=function(e){var t=this;Models.Player.prototype.handleInput.call(this,e),this.isWinningMove()&&(this.state=this.State.WON,setTimeout(function(){t.state=t.State.RESET},1200))},Models.GemCollectorPlayer=function(e){Models.Player.call(this,e),Object.defineProperty(this,"initialOrigin",{get:function(){var e=2*this.blockOffset.x,t=this.spriteOffset.y+3*this.blockOffset.y;return{x:e,y:t}}}),this.origin=this.initialOrigin},Models.GemCollectorPlayer.prototype=Object.create(Models.Player.prototype),Models.GemCollectorPlayer.prototype.isValidMove=function(e){var t=this.mapLocationIndices(),i=t.x,n=t.y;switch(e){case"left":i-=1;break;case"up":n-=1;break;case"right":i+=1;break;case"down":n+=1}return!(i<0||i>4||n<0||n>5)},Models.Gem=function(t){Models.Entity.call(this,t),this.State={SPAWNED:0,COLLECTED:1,SCORING:2,DESPAWNED:3},this.state=this.State.SPAWNED,this.lLifespan=0,this.lInitialTime=null,this.lPercentComplete=null,this.lAnimationDuration=500,this.origin={x:this.blockOffset.x*e(0,4),y:this.spriteOffset.y+this.blockOffset.y*e(0,5)},this.collisionOffset={x:1,y:77},this.collisionSize={width:98,height:66}},Models.Gem.prototype=Object.create(Models.Entity.prototype),Models.Gem.prototype.update=function(){ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);var e=Date.now();null===this.lInitialTime?this.lInitialTime=e:this.state===this.State.SPAWNED?(this.lPercentComplete=(e-this.lInitialTime)/this.lLifespan,this.lPercentComplete>1&&(this.state=this.State.DESPAWNED)):this.state===this.State.SCORING&&(this.lPercentComplete=(e-this.lInitialTime)/this.lAnimationDuration,this.lPercentComplete<=1?this.origin=i(this.origin,{x:this.origin.x,y:this.origin.y-7.5},this.lPercentComplete):this.state=this.State.COLLECTED)},Models.Gem.prototype.resetUpdate=function(){this.lInitialTime=this.lPercentComplete=null},Models.Gem.prototype.render=function(){var e=this.origin;if(ctx.drawImage(Resources.get(this.sprite),e.x,e.y),this.state===this.State.SCORING){ctx.font="54px VT323",ctx.fillStyle="white",ctx.strokeStyle="blue",ctx.textAlign="center";var t=this.origin.x+this.spriteSize.width/2,i=this.origin.y+this.spriteSize.height/1.5;ctx.fillText("+"+this.value,t,i),ctx.strokeText("+"+this.value,t,i)}},Models.GreenGem=function(t){Models.Gem.call(this,t),this.lLifespan=1e3*e(3,7),this.value=1},Models.GreenGem.prototype=Object.create(Models.Gem.prototype),Models.BlueGem=function(t){Models.Gem.call(this,t),this.lLifespan=1e3*e(2,5),this.value=3},Models.BlueGem.prototype=Object.create(Models.Gem.prototype),Models.OrangeGem=function(t){Models.Gem.call(this,t),this.lLifespan=1e3*e(1,3),this.value=5},Models.OrangeGem.prototype=Object.create(Models.Gem.prototype)}();var allEnemies=[],player=null,gems=[],allowedKeys={37:"left",38:"up",39:"right",40:"down"};document.addEventListener("keyup",function(e){null!==player&&player.state===player.State.PLAYING&&Engine.currentGame()===Engine.Game.FROGGER&&player.handleInput(allowedKeys[e.keyCode])}),document.addEventListener("keydown",function(e){null===player||player.state!==player.State.PLAYING&&player.state!==player.State.INVINCIBILITY||Engine.currentGame()!==Engine.Game.GEM_COLLECTOR||player.handleInput(allowedKeys[e.keyCode])}),document.addEventListener("click",function(e){Engine.onClick(ctx.canvas,e)}),function(e){function t(){var e=Date.now(),i=(e-O)/1e3;switch(k){case N.MENU_GAME_SELECT:d(b);break;case N.MENU_PLAYER_SELECT:f(v);break;case N.LEVEL_FROGGER:n(i),G(C);break;case N.LEVEL_GEM_COLLECTOR:_.clearRect(0,0,L.width,L.height),n(i),S(P)}O=e,T.requestAnimationFrame(t)}function i(){O=Date.now(),t()}function n(e){s(e),g()}function s(e){w===x.GEM_COLLECTOR&&(y()&&u(),gems.forEach(function(t,i){t.update(e);var n=t.state;n!==t.State.COLLECTED&&n!==t.State.DESPAWNED||gems.splice(i,1)})),allEnemies.forEach(function(t){t.update(e)}),player.update()}function a(e){var t=Models.EntityType;switch(e){case"images/char-boy.png":return t.BOY;case"images/char-cat-girl.png":return t.GIRL_CAT;case"images/char-horn-girl.png":return t.GIRL_HORN;case"images/char-pink-girl.png":return t.GIRL_PINK;case"images/char-princess-girl.png":return t.GIRL_PRINCESS;default:return}}function r(){return{froggerHitBox:{x:Models.SPRITE_WIDTH,y:2*Models.SPRITE_Y_OFFSET+Models.SPRITE_Y_INITIAL_POSITION,width:3*Models.SPRITE_WIDTH,height:Models.SPRITE_Y_OFFSET},gemCollectorHitBox:{x:Models.SPRITE_WIDTH,y:5*Models.SPRITE_Y_OFFSET+Models.SPRITE_Y_INITIAL_POSITION,width:3*Models.SPRITE_WIDTH,height:Models.SPRITE_Y_OFFSET}}}function o(e){var t,i,n=[],s=e.players;for(t=0;t<s.numRows;++t)for(i=0;i<s.numCols;++i){var r=s.images[t][i];null!==r&&n.push({entityType:a(r),collisionRect:{x:i*Models.SPRITE_WIDTH,y:t*Models.SPRITE_Y_OFFSET-Models.SPRITE_Y_INITIAL_POSITION,width:Models.SPRITE_WIDTH,height:Models.PLAYER_SPRITE_COLLISION_HEIGHT}})}return n}function l(){return k}function c(){return w}function h(e,t){switch(e){case N.MENU_GAME_SELECT:case N.MENU_PLAYER_SELECT:break;case N.LEVEL_FROGGER:_.clearRect(0,0,L.width,L.height),null===player&&(player=new Models.FroggerPlayer(t.entityType));break;case N.LEVEL_GEM_COLLECTOR:_.clearRect(0,0,L.width,L.height),null===player&&(player=new Models.GemCollectorPlayer(t.entityType))}k=e}function p(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.height+e.y>t.y}function g(){var e=player.collisionRect();gems.forEach(function(t){t.state===t.State.SPAWNED&&p(e,t.collisionRect())&&(t.state=t.State.SCORING,t.resetUpdate(),W+=t.value)}),allEnemies.forEach(function(t){player.state===player.State.PLAYING&&p(e,t.collisionRect())&&(F>0?--F:(F=5,W=0),player.state=player.State.RESET)})}function y(){var e=Math.ceil(0),t=Math.floor(100),i=Math.floor(Math.random()*(t-e+1))+e;return i<1&&gems.length<4}function u(){var e,t=Math.ceil(0),i=Math.floor(100),n=Math.floor(Math.random()*(i-t+1))+t;e=n<5?new Models.OrangeGem(Models.EntityType.GEM_ORANGE):n>=5&&n<20?new Models.BlueGem(Models.EntityType.GEM_BLUE):new Models.GreenGem(Models.EntityType.GEM_GREEN),gems.push(e)}function E(e,t,i){var n,s;for(n=0;n<e.numRows;++n)for(s=0;s<e.numCols;++s){var a=e.images[n][s];null!==a&&_.drawImage(Resources.get(a),101*s+t,83*n+i)}}function m(e,t,i,n,s){_.font="54px VT323",_.fillStyle=i,_.strokeStyle=n,_.textAlign="center",_.fillText(s,e,t),_.strokeText(s,e,t)}function d(e){_.clearRect(0,0,_.canvas.width,_.canvas.height),E(e.map,0,0),m(L.width/2,L.height/16,"green","blue","CHOOSE A GAME!"),m(L.width/2,L.height/3.2,"white","green","FROGGER"),m(L.width/2,L.height/1.39,"white","blue","GEM HUNTER")}function f(e){_.clearRect(0,0,_.canvas.width,_.canvas.height),E(e.map,0,0),E(e.players,0,Models.SPRITE_Y_INITIAL_POSITION),m(L.width/2,L.height/16,"green","blue","CHOOSE A TOON!")}function G(e){E(e.map,0,0),M()}function S(e){E(e.map,0,0),M();var t="LIVES: "+F+"  SCORE: "+W;m(L.width/2,L.height/16,"green","blue",t)}function M(){gems.forEach(function(e){e.render()}),player.render(),allEnemies.forEach(function(e){e.render()})}function I(e,t){var i=e.getBoundingClientRect(),n=t.clientX-i.left,s=t.clientY-i.top,a={x:n,y:s,width:1,height:1};switch(k){case N.MENU_GAME_SELECT:if(p(a,r.froggerHitBox)){w=x.FROGGER;for(var o=0;o<4;++o)allEnemies.push(new Models.FroggerEnemy(Models.EntityType.BUG))}if(p(a,r.gemCollectorHitBox)){w=x.GEM_COLLECTOR;for(var o=0;o<5;++o)allEnemies.push(new Models.GemCollectorEnemy(Models.EntityType.BUG))}w!==x.UNSELECTED&&h(N.MENU_PLAYER_SELECT,null);break;case N.MENU_PLAYER_SELECT:A.forEach(function(e){if(p(a,e.collisionRect))switch(w){case x.FROGGER:h(N.LEVEL_FROGGER,{entityType:e.entityType});break;case x.GEM_COLLECTOR:h(N.LEVEL_GEM_COLLECTOR,{entityType:e.entityType})}})}}var O,R=e.document,T=e.window,L=R.createElement("canvas"),_=L.getContext("2d");L.width=505,L.height=606,R.body.appendChild(L);var b=new Menus.GameSelect,v=new Menus.PlayerSelect,C=new Levels.Frogger,P=new Levels.GemCollector,x={FROGGER:0,GEM_COLLECTOR:1,UNSELECTED:2},w=x.UNSELECTED,N={MENU_GAME_SELECT:0,MENU_PLAYER_SELECT:1,LEVEL_FROGGER:2,LEVEL_GEM_COLLECTOR:3},k=N.MENU_GAME_SELECT,r=r(),A=o(v),W=0,F=5;Resources.load(["images/block-stone.png","images/block-water.png","images/block-grass.png","images/obj-speech-bubble.png","images/enemy-bug.png","images/char-boy.png","images/char-boy-inv.png","images/char-cat-girl.png","images/char-cat-girl-inv.png","images/char-horn-girl.png","images/char-horn-girl-inv.png","images/char-pink-girl.png","images/char-pink-girl-inv.png","images/char-princess-girl.png","images/char-princess-girl-inv.png","images/gem-green.png","images/gem-blue.png","images/gem-orange.png"]),Resources.onReady(i),e.ctx=_,window.Engine={onClick:I,currentState:l,State:N,currentGame:c,Game:x}}(this);