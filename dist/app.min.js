!function(){function e(e){e instanceof Array?e.forEach(function(e){t(e)}):t(e)}function t(e){if(a[e])return a[e];var t=new Image;t.onload=function(){a[e]=t,r()&&s.forEach(function(e){e()})},a[e]=!1,t.src=e}function i(e){return a[e]}function r(){var e=!0;for(var t in a)a.hasOwnProperty(t)&&!a[t]&&(e=!1);return e}function n(e){s.push(e)}var a={},s=[];window.Resources={load:e,get:i,onReady:n,isReady:r}}();var Menus={MapSpriteUrl:{W:"images/block-water.png",S:"images/block-stone.png",G:"images/block-grass.png",_:null},CharacterSpriteUrl:{B:"images/char-boy.png",C:"images/char-cat-girl.png",H:"images/char-horn-girl.png",P:"images/char-pink-girl.png",R:"images/char-princess-girl.png",_:null}};!function(){Menus.CharacterSelect=function(){var e=Menus.MapSpriteUrl;this.map={images:[[e.G,e.G,e.G,e.G,e.G],[e.G,e.G,e.G,e.G,e.G],[e.W,e.S,e.S,e.S,e.W],[e.W,e.W,e.S,e.W,e.W],[e.W,e.S,e.S,e.S,e.W],[e.G,e.G,e.G,e.G,e.G]],numRows:6,numCols:5},e=Menus.CharacterSpriteUrl,this.characters={images:[[e._,e._,e._,e._,e._],[e._,e._,e._,e._,e._],[e._,e.H,e._,e.B,e._],[e._,e._,e.R,e._,e._],[e._,e.P,e._,e.C,e._],[e._,e._,e._,e._,e._]],numRows:6,numCols:5}}}();var Levels={MapSpriteUrl:{W:"images/block-water.png",S:"images/block-stone.png",G:"images/block-grass.png",_:null}};!function(){Levels.Frogger=function(){var e=Levels.MapSpriteUrl;this.map={images:[[e.W,e.W,e.S,e.W,e.W],[e.S,e.S,e.S,e.S,e.S],[e.S,e.S,e.S,e.S,e.S],[e.S,e.S,e.S,e.S,e.S],[e.G,e.G,e.G,e.G,e.G],[e.G,e.G,e.G,e.G,e.G]],numRows:6,numCols:5}},Levels.Collector=function(){var e=Levels.MapSpriteUrl;this.map={images:[[e.S,e.G,e.G,e.G,e.S],[e.G,e.G,e.G,e.G,e.G],[e.G,e.G,e.G,e.G,e.G],[e.G,e.G,e.G,e.G,e.G],[e.G,e.G,e.G,e.G,e.G],[e.S,e.G,e.G,e.G,e.S]],numRows:6,numCols:5}}}();const SPRITE_WIDTH=101,SPRITE_HEIGHT=171,SPRITE_Y_INITIAL_POSITION=-30,SPRITE_Y_OFFSET=83,PLAYER_SPRITE_COLLISION_X_OFFSET=30,PLAYER_SPRITE_COLLISION_Y_OFFSET=62,PLAYER_SPRITE_COLLISION_WIDTH=40,PLAYER_SPRITE_COLLISION_HEIGHT=76,LEFT_BOUNDS=0,UPPER_BOUNDS=-30,RIGHT_BOUNDS=404,LOWER_BOUNDS=385,NON_MIDDLE_UPPER_BOUNDS=53;var Models={CharacterType:{BOY:0,GIRL_CAT:1,GIRL_HORN:2,GIRL_PINK:3,GIRL_PRINCESS:4,BUG:5}};!function(){var e=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e},t=function(e){return e===UPPER_BOUNDS},i=function(e){var t;switch(e){case Models.CharacterType.BOY:t="images/char-boy.png";break;case Models.CharacterType.BUG:t="images/enemy-bug.png";break;case Models.CharacterType.GIRL_CAT:t="images/char-cat-girl.png";break;case Models.CharacterType.GIRL_HORN:t="images/char-horn-girl.png";break;case Models.CharacterType.GIRL_PINK:t="images/char-pink-girl.png";break;case Models.CharacterType.GIRL_PRINCESS:t="images/char-princess-girl.png";break;default:t=void 0}return t};Models.Character=function(e){this.characterType=e,this.sprite=i(e),this.spriteSize={width:101,height:171},this.spriteOffset={x:0,y:-30},this.blockOffset={x:101,y:83},this.chatBubbleSprite=Resources.get("images/obj-speech-bubble.png")},Models.Character.prototype.rect=function(){return{x:this.origin.x+this.collisionOffset.x,y:this.origin.y+this.collisionOffset.y,width:this.collisionSize.width,height:this.collisionSize.height}},Models.Character.prototype.isOnCanvas=function(){var e=this.origin.x,t=this.origin.y;return e>-this.spriteSize.width&&e<ctx.canvas.width&&t>=UPPER_BOUNDS&&t<=LOWER_BOUNDS},Models.Enemy=function(t){Models.Character.call(this,t),this.collisionOffset={x:1,y:77},this.collisionSize={width:98,height:66},Object.defineProperty(this,"initialOrigin",{get:function(){var t=-this.blockOffset.x,i=this.spriteOffset.y+this.blockOffset.y*e(1,3);return{x:t,y:i}}}),this.origin=this.initialOrigin,this.velocity=e(1,6)},Models.Enemy.prototype=Object.create(Models.Character.prototype),Models.Enemy.prototype.update=function(e){this.origin.x+=this.spriteSize.width*this.velocity*e},Models.Enemy.prototype.render=function(){this.isOnCanvas()?ctx.drawImage(Resources.get(this.sprite),this.origin.x,this.origin.y):(this.origin=this.initialOrigin,this.velocity=e(1,6))},Models.Player=function(e){Models.Character.call(this,e),this.State={PLAYING:0,WON:1,LOST:2},this.state=this.State.PLAYING,this.collisionOffset={x:30,y:62},this.collisionSize={width:40,height:70},Object.defineProperty(this,"initialOrigin",{get:function(){var e=2*this.blockOffset.x,t=this.spriteOffset.y+5*this.blockOffset.y;return{x:e,y:t}}}),this.origin=this.initialOrigin},Models.Player.prototype=Object.create(Models.Character.prototype);var r=300,n=null,a=null,s=null,o=function(e,t,i){var r=t.x-e.x,n=t.y-e.y;return{x:e.x+r*i,y:e.y+n*i}};Models.Player.prototype.update=function(e){if(this.state===this.State.WON)ctx.font="20px VT323",ctx.fillStyle="black",ctx.textAlign="center";else if(this.state===this.State.LOST){var t=Date.now();null===n?(n=t,s=this.origin):(a=(t-n)/r,a<=1?this.origin=o(s,this.initialOrigin,a):(this.state=this.State.PLAYING,n=a=s=null,this.origin=this.initialOrigin))}},Models.Player.prototype.render=function(){if(this.isOnCanvas()){var e=this.origin;if(ctx.drawImage(Resources.get(this.sprite),e.x,e.y),this.state===this.State.WON){var t=this.collisionSize;ctx.drawImage(this.chatBubbleSprite,e.x+t.width,e.y+t.height/2),ctx.fillText(this.chatBubbleText(),e.x+this.spriteSize.width,e.y+t.height)}}},Models.Player.prototype.isValidMove=function(e){var t=this.origin.x,i=this.origin.y;return!("left"===e&&t===LEFT_BOUNDS||"up"===e&&i===UPPER_BOUNDS||"up"===e&&t!==2*this.blockOffset.x&&i===NON_MIDDLE_UPPER_BOUNDS||"right"===e&&t===RIGHT_BOUNDS||"down"===e&&i===LOWER_BOUNDS)},Models.Player.prototype.chatBubbleText=function(){var e=Models.CharacterType;switch(this.characterType){case e.BOY:return"I h8 winning";case e.GIRL_CAT:return"NYAN!!!";case e.GIRL_HORN:return"No problem";case e.GIRL_PINK:return"*headbangs*";case e.GIRL_PRINCESS:return"Bless you!"}},Models.Player.prototype.handleInput=function(e){var i=Engine.currentState(),r=Engine.State;if(i===r.LEVEL_FROGGER||i===r.LEVEL_COLLECTOR){if(this.isValidMove(e)&&this.state===this.State.PLAYING){var n=this.origin,a=this.blockOffset;switch(e){case"left":n.x-=a.x;break;case"up":n.y-=a.y;break;case"right":n.x+=a.x;break;case"down":n.y+=a.y}}t(this.origin.y)&&(this.state=this.State.WON,setTimeout(function(){ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height),this.origin=this.initialOrigin,this.state=this.State.PLAYING}.bind(this),1200))}}}();var numEnemies=4,allEnemies=[];for(i=0;i<numEnemies;++i)allEnemies.push(new Models.Enemy(Models.CharacterType.BUG));var player=null;document.addEventListener("keyup",function(e){var t={37:"left",38:"up",39:"right",40:"down"};null!==player&&player.handleInput(t[e.keyCode])}),document.addEventListener("click",function(e){Engine.onClick(ctx.canvas,e)}),function(e){function t(){var e=Date.now(),i=(e-_)/1e3;switch(m){case I.MENU_CHARACTER_SELECT:h(G);break;case I.LEVEL_FROGGER:r(i),g(L);break;case I.LEVEL_COLLECTOR:}_=e,O.requestAnimationFrame(t)}function i(){p(),_=Date.now(),t()}function r(e){n(e),c()}function n(e){allEnemies.forEach(function(t){t.update(e)}),player.update()}function a(){return m}function s(e,t){switch(e){case I.MENU_CHARACTER_SELECT:break;case I.LEVEL_FROGGER:d.clearRect(0,0,R.width,R.height),null===player&&(player=new Models.Player(t.characterType));break;case I.LEVEL_COLLECTOR:}m=e}function o(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.height+e.y>t.y}function c(){var e,t=player.rect();allEnemies.forEach(function(i){e=i.rect(),o(t,e)&&(player.state=player.State.LOST)})}function l(e,t,i){for(row=0;row<e.numRows;++row)for(col=0;col<e.numCols;++col){var r=e.images[row][col];null!==r&&d.drawImage(Resources.get(r),101*col+t,83*row+i)}}function h(e){d.clearRect(0,0,d.canvas.width,d.canvas.height),l(e.map,0,0),l(e.characters,0,SPRITE_Y_INITIAL_POSITION),d.font="54px VT323",d.fillStyle="green",d.strokeStyle="blue",d.textAlign="center";var t=d.canvas.width/2,i=d.canvas.height/16;d.fillText("CHOOSE A TOON!",t,i),d.strokeText("CHOOSE A TOON!",t,i)}function g(e){l(e.map,0,0),u()}function u(){player.render(),allEnemies.forEach(function(e){e.render()})}function p(){}function S(e,t){var i=e.getBoundingClientRect(),r=t.clientX-i.left,n=t.clientY-i.top;if(m===I.MENU_CHARACTER_SELECT){var a={x:r,y:n,width:1,height:1};T.forEach(function(e){o(a,e.rect)&&s(I.LEVEL_FROGGER,{characterType:e.characterType})})}}function f(e){var t=Models.CharacterType;switch(e){case"images/char-boy.png":return t.BOY;case"images/char-cat-girl.png":return t.GIRL_CAT;case"images/char-horn-girl.png":return t.GIRL_HORN;case"images/char-pink-girl.png":return t.GIRL_PINK;case"images/char-princess-girl.png":return t.GIRL_PRINCESS;default:return}}function E(e){var t=[],i=e.characters;for(row=0;row<i.numRows;++row)for(col=0;col<i.numCols;++col){var r=i.images[row][col];null!==r&&t.push({characterType:f(r),rect:{x:col*SPRITE_WIDTH,y:row*SPRITE_Y_OFFSET-SPRITE_Y_INITIAL_POSITION,width:SPRITE_WIDTH,height:PLAYER_SPRITE_COLLISION_HEIGHT}})}return t}var _,y=e.document,O=e.window,R=y.createElement("canvas"),d=R.getContext("2d"),G=new Menus.CharacterSelect,L=new Levels.Frogger,I=(new Levels.Collector,{MENU_CHARACTER_SELECT:1,LEVEL_FROGGER:2,LEVEL_COLLECTOR:3}),m=I.MENU_CHARACTER_SELECT,T=E(G);R.width=505,R.height=606,y.body.appendChild(R),Resources.load(["images/block-stone.png","images/block-water.png","images/block-grass.png","images/obj-speech-bubble.png","images/enemy-bug.png","images/char-boy.png","images/char-cat-girl.png","images/char-horn-girl.png","images/char-pink-girl.png","images/char-princess-girl.png"]),Resources.onReady(i),e.ctx=d,window.Engine={onClick:S,currentState:a,State:I}}(this);